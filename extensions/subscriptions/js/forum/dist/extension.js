System.register("subscriptions/addSubscriptionBadge",["flarum/extend","flarum/models/Discussion","flarum/components/Badge"],function(t){"use strict";function n(){o(e.prototype,"badges",function(t){var n=void 0;switch(this.subscription()){case"follow":n=i.component({label:app.trans("subscriptions.following"),icon:"star",type:"following"});break;case"ignore":n=i.component({label:app.trans("subscriptions.ignoring"),icon:"eye-slash",type:"ignoring"})}n&&t.add("subscription",n)})}var o,e,i;return t("default",n),{setters:[function(t){o=t.extend},function(t){e=t["default"]},function(t){i=t["default"]}],execute:function(){}}}),System.register("subscriptions/addSubscriptionControls",["flarum/extend","flarum/components/Button","flarum/components/DiscussionPage","flarum/utils/DiscussionControls","subscriptions/components/SubscriptionMenu"],function(t){"use strict";function n(){o(r,"userControls",function(t,n,o){if(app.session.user&&!(o instanceof i)){var r={none:{label:app.trans("subscriptions.follow"),icon:"star",save:"follow"},follow:{label:app.trans("subscriptions.unfollow"),icon:"star-o",save:!1},ignore:{label:app.trans("subscriptions.unignore"),icon:"eye",save:!1}},s=n.subscription()||"none";t.add("subscription",e.component({children:r[s].label,icon:r[s].icon,onclick:n.save.bind(n,{subscription:r[s].save})}))}}),o(i.prototype,"sidebarItems",function(t){if(app.session.user){var n=this.discussion;t.add("subscription",s.component({discussion:n}))}})}var o,e,i,r,s;return t("default",n),{setters:[function(t){o=t.extend},function(t){e=t["default"]},function(t){i=t["default"]},function(t){r=t["default"]},function(t){s=t["default"]}],execute:function(){}}}),System.register("subscriptions/addSubscriptionFilter",["flarum/extend","flarum/components/LinkButton","flarum/components/IndexPage","flarum/components/DiscussionList"],function(t){"use strict";function n(){o(i.prototype,"navItems",function(t){if(app.session.user){var n=this.stickyParams();n.filter="following",t.add("following",e.component({href:app.route("index.filter",n),children:app.trans("subscriptions.following"),icon:"star"}),50)}}),o(r.prototype,"requestParams",function(t){"following"===this.props.params.filter&&(t.filter.q=(t.filter.q||"")+" is:following")})}var o,e,i,r;return t("default",n),{setters:[function(t){o=t.extend},function(t){e=t["default"]},function(t){i=t["default"]},function(t){r=t["default"]}],execute:function(){}}}),System.register("subscriptions/main",["flarum/extend","flarum/app","flarum/Model","flarum/models/Discussion","flarum/components/NotificationGrid","subscriptions/addSubscriptionBadge","subscriptions/addSubscriptionControls","subscriptions/addSubscriptionFilter","subscriptions/components/NewPostNotification"],function(t){"use strict";var n,o,e,i,r,s,u,c,a;return{setters:[function(t){n=t.extend},function(t){o=t["default"]},function(t){e=t["default"]},function(t){i=t["default"]},function(t){r=t["default"]},function(t){s=t["default"]},function(t){u=t["default"]},function(t){c=t["default"]},function(t){a=t["default"]}],execute:function(){o.initializers.add("subscriptions",function(){o.notificationComponents.newPost=a,i.prototype.subscription=e.attribute("subscription"),s(),u(),c(),n(r.prototype,"notificationTypes",function(t){t.add("newPost",{name:"newPost",icon:"star",label:o.trans("subscriptions.notify_new_post")})})})}}}),System.register("subscriptions/components/NewPostNotification",["flarum/components/Notification","flarum/helpers/username"],function(t){"use strict";function n(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}function o(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function, not "+typeof n);t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),n&&(Object.setPrototypeOf?Object.setPrototypeOf(t,n):t.__proto__=n)}var e,i,r,s=function(){function t(t,n){for(var o=0;o<n.length;o++){var e=n[o];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,e.key,e)}}return function(n,o,e){return o&&t(n.prototype,o),e&&t(n,e),n}}(),u=function(t,n,o){for(var e=!0;e;){var i=t,r=n,s=o;u=a=c=void 0,e=!1,null===i&&(i=Function.prototype);var u=Object.getOwnPropertyDescriptor(i,r);if(void 0!==u){if("value"in u)return u.value;var c=u.get;return void 0===c?void 0:c.call(s)}var a=Object.getPrototypeOf(i);if(null===a)return void 0;t=a,n=r,o=s,e=!0}};return{setters:[function(t){e=t["default"]},function(t){i=t["default"]}],execute:function(){r=function(t){function e(){n(this,e),u(Object.getPrototypeOf(e.prototype),"constructor",this).apply(this,arguments)}return o(e,t),s(e,[{key:"icon",value:function(){return"star"}},{key:"href",value:function(){var t=this.props.notification,n=t.subject(),o=t.content()||{};return app.route.discussion(n,o.postNumber)}},{key:"content",value:function(){return app.trans("subscriptions.new_post_notification",{user:this.props.notification.sender()})}}]),e}(e),t("default",r)}}}),System.register("subscriptions/components/SubscriptionMenu",["flarum/Component","flarum/components/Button","flarum/helpers/icon","subscriptions/components/SubscriptionMenuItem"],function(t){"use strict";function n(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}function o(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function, not "+typeof n);t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),n&&(Object.setPrototypeOf?Object.setPrototypeOf(t,n):t.__proto__=n)}var e,i,r,s,u,c=function(){function t(t,n){for(var o=0;o<n.length;o++){var e=n[o];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,e.key,e)}}return function(n,o,e){return o&&t(n.prototype,o),e&&t(n,e),n}}(),a=function(t,n,o){for(var e=!0;e;){var i=t,r=n,s=o;u=a=c=void 0,e=!1,null===i&&(i=Function.prototype);var u=Object.getOwnPropertyDescriptor(i,r);if(void 0!==u){if("value"in u)return u.value;var c=u.get;return void 0===c?void 0:c.call(s)}var a=Object.getPrototypeOf(i);if(null===a)return void 0;t=a,n=r,o=s,e=!0}};return{setters:[function(t){e=t["default"]},function(t){i=t["default"]},function(t){r=t["default"]},function(t){s=t["default"]}],execute:function(){u=function(t){function e(){n(this,e),a(Object.getPrototypeOf(e.prototype),"constructor",this).apply(this,arguments)}return o(e,t),c(e,[{key:"view",value:function(){var t=this,n=this.props.discussion,o=n.subscription(),e=app.trans("subscriptions.follow"),u="star-o",c="SubscriptionMenu-button--"+o;switch(o){case"follow":e=app.trans("subscriptions.following"),u="star";break;case"ignore":e=app.trans("subscriptions.ignoring"),u="eye-slash"}var a=[{subscription:!1,icon:"star-o",label:app.trans("subscriptions.not_following"),description:app.trans("subscriptions.not_following_description")},{subscription:"follow",icon:"star",label:app.trans("subscriptions.following"),description:app.trans("subscriptions.following_description")},{subscription:"ignore",icon:"eye-slash",label:app.trans("subscriptions.ignoring"),description:app.trans("subscriptions.ignoring_description")}];return m("div",{className:"Dropdown ButtonGroup SubscriptionMenu"},i.component({className:"Button SubscriptionMenu-button "+c,icon:u,children:e,onclick:this.saveSubscription.bind(this,n,-1!==["follow","ignore"].indexOf(o)?!1:"follow")}),m("button",{className:"Dropdown-toggle Button Button--icon "+c,"data-toggle":"dropdown"},r("caret-down",{className:"Button-icon"})),m("ul",{className:"Dropdown-menu dropdown-menu Dropdown-menu--right"},a.map(function(e){return e.onclick=t.saveSubscription.bind(t,n,e.subscription),e.active=o===e.subscription,m("li",null,s.component(e))})))}},{key:"saveSubscription",value:function(t,n){t.save({subscription:n})}}]),e}(e),t("default",u)}}}),System.register("subscriptions/components/SubscriptionMenuItem",["flarum/Component","flarum/helpers/icon"],function(t){"use strict";function n(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}function o(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function, not "+typeof n);t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),n&&(Object.setPrototypeOf?Object.setPrototypeOf(t,n):t.__proto__=n)}var e,i,r,s=function(){function t(t,n){for(var o=0;o<n.length;o++){var e=n[o];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,e.key,e)}}return function(n,o,e){return o&&t(n.prototype,o),e&&t(n,e),n}}(),u=function(t,n,o){for(var e=!0;e;){var i=t,r=n,s=o;u=a=c=void 0,e=!1,null===i&&(i=Function.prototype);var u=Object.getOwnPropertyDescriptor(i,r);if(void 0!==u){if("value"in u)return u.value;var c=u.get;return void 0===c?void 0:c.call(s)}var a=Object.getPrototypeOf(i);if(null===a)return void 0;t=a,n=r,o=s,e=!0}};return{setters:[function(t){e=t["default"]},function(t){i=t["default"]}],execute:function(){r=function(t){function e(){n(this,e),u(Object.getPrototypeOf(e.prototype),"constructor",this).apply(this,arguments)}return o(e,t),s(e,[{key:"view",value:function(){return m("button",{className:"SubscriptionMenuItem hasIcon",onclick:this.props.onclick},this.props.active?i("check",{className:"Button-icon"}):"",m("span",{className:"SubscriptionMenuItem-label"},i(this.props.icon,{className:"Button-icon"}),m("strong",null,this.props.label),m("span",{className:"SubscriptionMenuItem-description"},this.props.description)))}}]),e}(e),t("default",r)}}});