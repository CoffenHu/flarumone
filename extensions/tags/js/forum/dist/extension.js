System.register("tags/models/Tag",["flarum/Model","flarum/utils/mixin","flarum/utils/computed"],function(t){"use strict";function e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var a,o,s,r,i=function(t,e,n){for(var a=!0;a;){var o=t,s=e,r=n;i=c=u=void 0,a=!1,null===o&&(o=Function.prototype);var i=Object.getOwnPropertyDescriptor(o,s);if(void 0!==i){if("value"in i)return i.value;var u=i.get;return void 0===u?void 0:u.call(r)}var c=Object.getPrototypeOf(o);if(null===c)return void 0;t=c,e=s,n=r,a=!0}};return{setters:[function(t){a=t["default"]},function(t){o=t["default"]},function(t){s=t["default"]}],execute:function(){r=function(t){function a(){e(this,a),i(Object.getPrototypeOf(a.prototype),"constructor",this).apply(this,arguments)}return n(a,t),a}(o(a,{name:a.attribute("name"),slug:a.attribute("slug"),description:a.attribute("description"),color:a.attribute("color"),backgroundUrl:a.attribute("backgroundUrl"),backgroundMode:a.attribute("backgroundMode"),position:a.attribute("position"),parent:a.hasOne("parent"),defaultSort:a.attribute("defaultSort"),isChild:a.attribute("isChild"),isHidden:a.attribute("isHidden"),discussionsCount:a.attribute("discussionsCount"),lastTime:a.attribute("lastTime",a.transformDate),lastDiscussion:a.hasOne("lastDiscussion"),isRestricted:a.attribute("isRestricted"),canStartDiscussion:a.attribute("canStartDiscussion"),isPrimary:s("position","parent",function(t,e){return null!==t&&e===!1})})),t("default",r)}}}),System.register("tags/utils/sortTags",[],function(t){"use strict";function e(t){return t.slice(0).sort(function(t,e){var n=t.position(),a=e.position(),o=t.parent(),s=e.parent();return null===n&&null===a?e.discussionsCount()-t.discussionsCount():null===a?-1:null===n?1:o===s?n-a:o?o===e?1:o.position()-a:s?s===t?-1:n-s.position():0})}return t("default",e),{setters:[],execute:function(){}}}),System.register("tags/helpers/tagIcon",[],function(t){"use strict";function e(t){var e=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];return e.className="icon TagIcon "+(e.className||""),t?(e.style=e.style||{},e.style.backgroundColor=t.color()):e.className+=" untagged",m("span",e)}return t("default",e),{setters:[],execute:function(){}}}),System.register("tags/helpers/tagLabel",["flarum/utils/extract"],function(t){"use strict";function e(t){var e=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];e.style=e.style||{},e.className="TagLabel "+(e.className||"");var a=n(e,"link");if(t){var o=t.color();o&&(e.style.backgroundColor=e.style.color=o,e.className+=" colored"),a&&(e.title=t.description()||"",e.href=app.route("tag",{tags:t.slug()}),e.config=m.route)}else e.className+=" untagged";return m(a?"a":"span",e,m("span",{className:"TagLabel-text"},t?t.name():app.trans("tags.deleted")))}var n;return t("default",e),{setters:[function(t){n=t["default"]}],execute:function(){}}}),System.register("tags/helpers/tagsLabel",["flarum/utils/extract","tags/helpers/tagLabel","tags/utils/sortTags"],function(t){"use strict";function e(t){var e=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],s=[],r=n(e,"link");return e.className="TagsLabel "+(e.className||""),t?o(t).forEach(function(e){(e||1===t.length)&&s.push(a(e,{link:r}))}):s.push(a()),m("span",e,s)}var n,a,o;return t("default",e),{setters:[function(t){n=t["default"]},function(t){a=t["default"]},function(t){o=t["default"]}],execute:function(){}}}),System.register("tags/addTagComposer",["flarum/extend","flarum/components/IndexPage","flarum/components/DiscussionComposer","tags/components/TagDiscussionModal","tags/helpers/tagsLabel"],function(t){"use strict";var e,n,a,o,s,r;return{setters:[function(t){e=t.extend,n=t.override},function(t){a=t["default"]},function(t){o=t["default"]},function(t){s=t["default"]},function(t){r=t["default"]}],execute:function(){t("default",function(){e(a.prototype,"composeNewDiscussion",function(t){var e=app.store.getBy("tags","slug",this.params().tags);e&&t.then(function(t){return t.tags=[e]})}),o.prototype.tags=[],o.prototype.chooseTags=function(){var t=this;app.modal.show(new s({selectedTags:this.tags.slice(0),onsubmit:function(e){t.tags=e,t.$("textarea").focus()}}))},e(o.prototype,"headerItems",function(t){t.add("tags",m("a",{className:"DiscussionComposer-changeTags",onclick:this.chooseTags.bind(this)},this.tags.length?r(this.tags):m("span",{className:"TagLabel untagged"},app.trans("tags.tag_new_discussion_link"))),10)}),n(o.prototype,"onsubmit",function(t){var e=this;this.tags.length?t():app.modal.show(new s({selectedTags:[],onsubmit:function(n){e.tags=n,t()}}))}),e(o.prototype,"data",function(t){t.relationships=t.relationships||{},t.relationships.tags=this.tags})})}}}),System.register("tags/addTagControl",["flarum/extend","flarum/utils/DiscussionControls","flarum/components/Button","tags/components/TagDiscussionModal"],function(t){"use strict";var e,n,a,o;return{setters:[function(t){e=t.extend},function(t){n=t["default"]},function(t){a=t["default"]},function(t){o=t["default"]}],execute:function(){t("default",function(){e(n,"moderationControls",function(t,e){e.canTag()&&t.add("tags",a.component({children:app.trans("tags.edit_discussion_tags_link"),icon:"tag",onclick:function(){return app.modal.show(new o({discussion:e}))}}))})})}}}),System.register("tags/addTagFilter",["flarum/extend","flarum/components/IndexPage","flarum/components/DiscussionList","tags/components/TagHero"],function(t){"use strict";var e,n,a,o,s;return{setters:[function(t){e=t.extend,n=t.override},function(t){a=t["default"]},function(t){o=t["default"]},function(t){s=t["default"]}],execute:function(){t("default",function(){a.prototype.currentTag=function(){var t=this.params().tags;return t?app.store.getBy("tags","slug",t):void 0},n(a.prototype,"hero",function(t){var e=this.currentTag();return e?s.component({tag:e}):t()}),e(a.prototype,"sidebarItems",function(t){var e=this.currentTag();if(e){var n=e.color();n&&(t.newDiscussion.content.props.style={backgroundColor:n})}}),e(a.prototype,"params",function(t){t.tags=m.route.param("tags")}),e(o.prototype,"requestParams",function(t){t.include.push("tags"),this.props.params.tags&&(t.filter.q=(t.filter.q||"")+" tag:"+this.props.params.tags)})})}}}),System.register("tags/addTagLabels",["flarum/extend","flarum/components/DiscussionListItem","flarum/components/DiscussionPage","flarum/components/DiscussionHero","tags/helpers/tagsLabel","tags/utils/sortTags"],function(t){"use strict";var e,n,a,o,s,r;return{setters:[function(t){e=t.extend},function(t){n=t["default"]},function(t){a=t["default"]},function(t){o=t["default"]},function(t){s=t["default"]},function(t){r=t["default"]}],execute:function(){t("default",function(){e(n.prototype,"infoItems",function(t){var e=this.props.discussion.tags();e&&e.length&&t.add("tags",s(e),10)}),e(a.prototype,"params",function(t){t.include.push("tags")}),e(o.prototype,"view",function(t){var e=r(this.props.discussion.tags());if(e&&e.length){var n=e[0].color();n&&(t.attrs.style={backgroundColor:n},t.attrs.className+=" DiscussionHero--colored")}}),e(o.prototype,"items",function(t){var e=this.props.discussion.tags();e&&e.length&&t.add("tags",s(e,{link:!0}),5)})})}}}),System.register("tags/addTagList",["flarum/extend","flarum/components/IndexPage","flarum/components/Separator","flarum/components/LinkButton","tags/components/TagLinkButton","tags/components/TagsPage","tags/utils/sortTags"],function(t){"use strict";var e,n,a,o,s,r,i;return{setters:[function(t){e=t.extend},function(t){n=t["default"]},function(t){a=t["default"]},function(t){o=t["default"]},function(t){s=t["default"]},function(t){r=t["default"]},function(t){i=t["default"]}],execute:function(){t("default",function(){e(n.prototype,"navItems",function(t){if(t.add("tags",o.component({icon:"th-large",children:app.trans("tags.tags"),href:app.route("tags")}),-10),!(app.current instanceof r)){t.add("separator",a.component(),-10);var e=this.stickyParams(),n=app.store.all("tags"),u=this.currentTag(),c=function(n){var a=u===n;!a&&u&&(a=u.parent()===n),t.add("tag"+n.id(),s.component({tag:n,params:e,active:a}),-10)};i(n).filter(function(t){return null!==t.position()&&(!t.isChild()||u&&(t.parent()===u||t.parent()===u.parent()))}).forEach(c);var l=n.filter(function(t){return null===t.position()}).sort(function(t,e){return e.discussionsCount()-t.discussionsCount()});l.splice(0,3).forEach(c),l.length&&t.add("moreTags",o.component({children:app.trans("tags.more"),href:app.route("tags")}),-10)}})})}}}),System.register("tags/main",["flarum/Model","flarum/models/Discussion","flarum/components/IndexPage","tags/models/Tag","tags/components/TagsPage","tags/components/DiscussionTaggedPost","tags/addTagList","tags/addTagFilter","tags/addTagLabels","tags/addTagControl","tags/addTagComposer"],function(t){"use strict";var e,n,a,o,s,r,i,u,c,l,f;return{setters:[function(t){e=t["default"]},function(t){n=t["default"]},function(t){a=t["default"]},function(t){o=t["default"]},function(t){s=t["default"]},function(t){r=t["default"]},function(t){i=t["default"]},function(t){u=t["default"]},function(t){c=t["default"]},function(t){l=t["default"]},function(t){f=t["default"]}],execute:function(){app.initializers.add("tags",function(t){t.routes.tags={path:"/tags",component:s.component()},t.routes.tag={path:"/t/:tags",component:a.component()},t.route.tag=function(e){return t.route("tag",{tags:e.slug()})},t.postComponents.discussionTagged=r,t.store.models.tags=o,n.prototype.tags=e.hasMany("tags"),n.prototype.canTag=e.attribute("canTag"),i(),u(),c(),l(),f()})}}}),System.register("tags/components/DiscussionTaggedPost",["flarum/components/EventPost","flarum/helpers/punctuate","tags/helpers/tagsLabel"],function(t){"use strict";function e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var a,o,s,r,i=function(){function t(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,n,a){return n&&t(e.prototype,n),a&&t(e,a),e}}(),u=function(t,e,n){for(var a=!0;a;){var o=t,s=e,r=n;i=c=u=void 0,a=!1,null===o&&(o=Function.prototype);var i=Object.getOwnPropertyDescriptor(o,s);if(void 0!==i){if("value"in i)return i.value;var u=i.get;return void 0===u?void 0:u.call(r)}var c=Object.getPrototypeOf(o);if(null===c)return void 0;t=c,e=s,n=r,a=!0}};return{setters:[function(t){a=t["default"]},function(t){o=t["default"]},function(t){s=t["default"]}],execute:function(){r=function(t){function a(){e(this,a),u(Object.getPrototypeOf(a.prototype),"constructor",this).apply(this,arguments)}return n(a,t),i(a,[{key:"icon",value:function(){return"tag"}},{key:"descriptionKey",value:function(){return"tags.discussion_tagged_post"}},{key:"descriptionData",value:function(){function t(t,e){return t.filter(function(t){return-1===e.indexOf(t)}).map(function(t){return app.store.getById("tags",t)})}var e=this.props.post,n=e.content()[0],a=e.content()[1],r=t(a,n),i=t(n,a),u=[];return r.length&&u.push(app.trans("tags.added_tags",{tags:s(r,{link:!0}),count:r})),i.length&&u.push(app.trans("tags.removed_tags",{tags:s(i,{link:!0}),count:i})),{action:o(u),count:r.length+i.length}}}]),a}(a),t("default",r)}}}),System.register("tags/components/TagDiscussionModal",["flarum/components/Modal","flarum/components/DiscussionPage","flarum/components/Button","flarum/helpers/highlight","flarum/utils/classList","flarum/utils/extractText","tags/helpers/tagLabel","tags/helpers/tagIcon","tags/utils/sortTags"],function(t){"use strict";function e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var a,o,s,r,i,u,c,l,f,p,d=function(){function t(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,n,a){return n&&t(e.prototype,n),a&&t(e,a),e}}(),g=function(t,e,n){for(var a=!0;a;){var o=t,s=e,r=n;i=c=u=void 0,a=!1,null===o&&(o=Function.prototype);var i=Object.getOwnPropertyDescriptor(o,s);if(void 0!==i){if("value"in i)return i.value;var u=i.get;return void 0===u?void 0:u.call(r)}var c=Object.getPrototypeOf(o);if(null===c)return void 0;t=c,e=s,n=r,a=!0}};return{setters:[function(t){a=t["default"]},function(t){o=t["default"]},function(t){s=t["default"]},function(t){r=t["default"]},function(t){i=t["default"]},function(t){u=t["default"]},function(t){c=t["default"]},function(t){l=t["default"]},function(t){f=t["default"]}],execute:function(){p=function(t){function a(){e(this,a);for(var t=arguments.length,n=Array(t),o=0;t>o;o++)n[o]=arguments[o];g(Object.getPrototypeOf(a.prototype),"constructor",this).apply(this,n),this.tags=f(app.store.all("tags").filter(function(t){return t.canStartDiscussion()})),this.selected=[],this.filter=m.prop(""),this.index=this.tags[0].id(),this.focused=!1,this.props.selectedTags?this.props.selectedTags.map(this.addTag.bind(this)):this.props.discussion&&this.props.discussion.tags().map(this.addTag.bind(this)),this.minPrimary=app.forum.attribute("minPrimaryTags"),this.maxPrimary=app.forum.attribute("maxPrimaryTags"),this.minSecondary=app.forum.attribute("minSecondaryTags"),this.maxSecondary=app.forum.attribute("maxSecondaryTags")}return n(a,t),d(a,[{key:"primaryCount",value:function(){return this.selected.filter(function(t){return t.isPrimary()}).length}},{key:"secondaryCount",value:function(){return this.selected.filter(function(t){return!t.isPrimary()}).length}},{key:"addTag",value:function(t){if(t.canStartDiscussion()){var e=t.parent();if(e){var n=this.selected.indexOf(e);-1===n&&this.selected.push(e)}this.selected.push(t)}}},{key:"removeTag",value:function(t){var e=this.selected.indexOf(t);-1!==e&&(this.selected.splice(e,1),this.selected.filter(function(e){return e.parent()===t}).forEach(this.removeTag.bind(this)))}},{key:"className",value:function(){return"TagDiscussionModal"}},{key:"title",value:function(){return this.props.discussion?app.trans("tags.edit_discussion_tags_title",{title:m("em",null,this.props.discussion.title())}):app.trans("tags.tag_new_discussion_title")}},{key:"getInstruction",value:function(t,e){return t<this.minPrimary?app.trans("tags.choose_primary_tags",{count:this.minPrimary-t}):e<this.minSecondary?app.trans("tags.choose_secondary_tags",{count:this.minSecondary-e}):""}},{key:"content",value:function(){var t=this,e=this.tags,n=this.filter().toLowerCase(),a=this.primaryCount(),o=this.secondaryCount();return e=e.filter(function(e){var n=e.parent();return n===!1||-1!==t.selected.indexOf(n)}),a>=app.forum.attribute("maxPrimaryTags")&&(e=e.filter(function(e){return!e.isPrimary()||-1!==t.selected.indexOf(e)})),o>=app.forum.attribute("maxSecondaryTags")&&(e=e.filter(function(e){return e.isPrimary()||-1!==t.selected.indexOf(e)})),n&&(e=e.filter(function(t){return t.name().substr(0,n.length).toLowerCase()===n})),-1===e.indexOf(this.index)&&(this.index=e[0]),[m("div",{className:"Modal-body"},m("div",{className:"TagDiscussionModal-form"},m("div",{className:"TagDiscussionModal-form-input"},m("div",{className:"TagsInput FormControl "+(this.focused?"focus":"")},m("span",{className:"TagsInput-selected"},this.selected.map(function(e){return m("span",{className:"TagsInput-tag",onclick:function(){t.removeTag(e),t.onready()}},c(e))})),m("input",{className:"FormControl",placeholder:u(this.getInstruction(a,o)),value:this.filter(),oninput:m.withAttr("value",this.filter),onkeydown:this.onkeydown.bind(this),onfocus:function(){return t.focused=!0},onblur:function(){return t.focused=!1}}))),m("div",{className:"TagDiscussionModal-form-submit App-primaryControl"},s.component({type:"submit",className:"Button Button--primary",disabled:a<this.minPrimary||o<this.minSecondary,icon:"check",children:app.trans("tags.confirm")})))),m("div",{className:"Modal-footer"},m("ul",{className:"TagDiscussionModal-list SelectTagList"},e.filter(function(e){return n||!e.parent()||-1!==t.selected.indexOf(e.parent())}).map(function(e){return m("li",{"data-index":e.id(),className:i({pinned:null!==e.position(),child:!!e.parent(),colored:!!e.color(),selected:-1!==t.selected.indexOf(e),active:t.index===e}),style:{color:e.color()},onmouseover:function(){return t.index=e},onclick:t.toggleTag.bind(t,e)},l(e),m("span",{className:"SelectTagListItem-name"},r(e.name(),n)),e.description()?m("span",{className:"SelectTagListItem-description"},e.description()):"")})))]}},{key:"toggleTag",value:function(t){var e=this.selected.indexOf(t);-1!==e?this.removeTag(t):this.addTag(t),this.filter()&&(this.filter(""),this.index=this.tags[0]),this.onready()}},{key:"onkeydown",value:function(t){switch(t.which){case 40:case 38:t.preventDefault(),this.setIndex(this.getCurrentNumericIndex()+(40===t.which?1:-1),!0);break;case 13:t.preventDefault(),t.metaKey||t.ctrlKey||-1!==this.selected.indexOf(this.index)?this.selected.length&&this.$("form").submit():this.getItem(this.index)[0].dispatchEvent(new Event("click"));break;case 8:0===t.target.selectionStart&&0===t.target.selectionEnd&&(t.preventDefault(),this.selected.splice(this.selected.length-1,1))}}},{key:"selectableItems",value:function(){return this.$(".TagDiscussionModal-list > li")}},{key:"getCurrentNumericIndex",value:function(){return this.selectableItems().index(this.getItem(this.index))}},{key:"getItem",value:function(t){return this.selectableItems().filter('[data-index="'+t.id()+'"]')}},{key:"setIndex",value:function(t,e){var n=this.selectableItems(),a=n.parent();0>t?t=n.length-1:t>=n.length&&(t=0);var o=n.eq(t);if(this.index=app.store.getById("tags",o.attr("data-index")),m.redraw(),e){var s=a.scrollTop(),r=a.offset().top,i=r+a.outerHeight(),u=o.offset().top,c=u+o.outerHeight(),l=void 0;r>u?l=s-r+u-parseInt(a.css("padding-top"),10):c>i&&(l=s-i+c+parseInt(a.css("padding-bottom"),10)),"undefined"!=typeof l&&a.stop(!0).animate({scrollTop:l},100)}}},{key:"onsubmit",value:function(t){t.preventDefault();var e=this.props.discussion,n=this.selected;e&&e.save({relationships:{tags:n}}).then(function(){app.current instanceof o&&app.current.stream.update(),m.redraw()}),this.props.onsubmit&&this.props.onsubmit(n),app.modal.close(),m.redraw.strategy("none")}}]),a}(a),t("default",p)}}}),System.register("tags/components/TagHero",["flarum/Component"],function(t){"use strict";function e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var a,o,s=function(){function t(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,n,a){return n&&t(e.prototype,n),a&&t(e,a),e}}(),r=function(t,e,n){for(var a=!0;a;){var o=t,s=e,r=n;i=c=u=void 0,a=!1,null===o&&(o=Function.prototype);var i=Object.getOwnPropertyDescriptor(o,s);if(void 0!==i){if("value"in i)return i.value;var u=i.get;return void 0===u?void 0:u.call(r)}var c=Object.getPrototypeOf(o);if(null===c)return void 0;t=c,e=s,n=r,a=!0}};return{setters:[function(t){a=t["default"]}],execute:function(){o=function(t){function a(){e(this,a),r(Object.getPrototypeOf(a.prototype),"constructor",this).apply(this,arguments)}return n(a,t),s(a,[{key:"view",value:function(){var t=this.props.tag,e=t.color();return m("header",{className:"Hero TagHero",style:e?{color:"#fff",backgroundColor:e}:""},m("div",{className:"container"},m("div",{className:"containerNarrow"},m("h2",{className:"Hero-title"},t.name()),m("div",{className:"Hero-subtitle"},t.description()))))}}]),a}(a),t("default",o)}}}),System.register("tags/components/TagLinkButton",["flarum/components/LinkButton","tags/helpers/tagIcon"],function(t){"use strict";function e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var a,o,s,r=function(){function t(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,n,a){return n&&t(e.prototype,n),a&&t(e,a),e}}(),i=function(t,e,n){for(var a=!0;a;){var o=t,s=e,r=n;i=c=u=void 0,a=!1,null===o&&(o=Function.prototype);var i=Object.getOwnPropertyDescriptor(o,s);if(void 0!==i){if("value"in i)return i.value;var u=i.get;return void 0===u?void 0:u.call(r)}var c=Object.getPrototypeOf(o);if(null===c)return void 0;t=c,e=s,n=r,a=!0}};return{setters:[function(t){a=t["default"]},function(t){o=t["default"]}],execute:function(){s=function(t){function a(){e(this,a),i(Object.getPrototypeOf(a.prototype),"constructor",this).apply(this,arguments)}return n(a,t),r(a,[{key:"view",value:function(){var t=this.props.tag,e=this.constructor.isActive(this.props),n=t&&t.description();return m("a",{className:"TagLinkButton hasIcon "+(t.isChild()?"child":""),href:this.props.href,config:m.route,style:e&&t?{color:t.color()}:"",title:n||""},o(t,{className:"Button-icon"}),this.props.children)}}],[{key:"initProps",value:function(t){var e=t.tag;t.params.tags=e?e.slug():"untagged",t.href=app.route("tag",t.params),t.children=e?e.name():app.trans("tags.untagged")}}]),a}(a),t("default",s)}}}),System.register("tags/components/TagsPage",["flarum/Component","flarum/components/IndexPage","flarum/helpers/listItems","flarum/helpers/humanTime","tags/helpers/tagLabel","tags/utils/sortTags"],function(t){"use strict";function e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var a,o,s,r,i,u,c,l=function(){function t(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,n,a){return n&&t(e.prototype,n),a&&t(e,a),e}}(),f=function(t,e,n){for(var a=!0;a;){var o=t,s=e,r=n;i=c=u=void 0,a=!1,null===o&&(o=Function.prototype);var i=Object.getOwnPropertyDescriptor(o,s);if(void 0!==i){if("value"in i)return i.value;var u=i.get;return void 0===u?void 0:u.call(r)}var c=Object.getPrototypeOf(o);if(null===c)return void 0;t=c,e=s,n=r,a=!0}};return{setters:[function(t){a=t["default"]},function(t){o=t["default"]},function(t){s=t["default"]},function(t){r=t["default"]},function(t){i=t["default"]},function(t){u=t["default"]}],execute:function(){c=function(t){function a(){e(this,a);for(var t=arguments.length,n=Array(t),o=0;t>o;o++)n[o]=arguments[o];f(Object.getPrototypeOf(a.prototype),"constructor",this).apply(this,n),this.tags=u(app.store.all("tags").filter(function(t){return!t.parent()})),app.current=this,app.history.push("tags"),app.drawer.hide(),app.modal.close()}return n(a,t),l(a,[{key:"view",value:function(){var t=this.tags.filter(function(t){return null!==t.position()}),e=this.tags.filter(function(t){return null===t.position()});return m("div",{className:"TagsPage"},o.prototype.hero(),m("div",{className:"container"},m("nav",{className:"TagsPage-nav IndexPage-nav sideNav",config:o.prototype.affixSidebar},m("ul",null,s(o.prototype.sidebarItems().toArray()))),m("div",{className:"TagsPage-content sideNavOffset"},m("ul",{className:"TagTiles"},t.map(function(t){var e=t.lastDiscussion(),n=app.store.all("tags").filter(function(e){return e.parent()===t});return m("li",{className:"TagTile "+(t.color()?"colored":""),style:{backgroundColor:t.color()}},m("a",{className:"TagTile-info",href:app.route.tag(t),config:m.route},m("h3",{className:"TagTile-name"},t.name()),m("p",{className:"TagTile-description"},t.description()),n?m("div",{className:"TagTile-children"},n.map(function(t){return m("a",{href:app.route.tag(t),config:function(t,e){e||($(t).on("click",function(t){return t.stopPropagation()}),m.route.apply(this,arguments))}},t.name())})):""),e?m("a",{className:"TagTile-lastDiscussion",href:app.route.discussion(e,e.lastPostNumber()),config:m.route},m("span",{className:"TagTile-lastDiscussion-title"},e.title()),r(e.lastTime())):m("span",{className:"TagTile-lastDiscussion"}))})),e.length?m("div",{className:"TagCloud"},e.map(function(t){t.color();return[i(t,{link:!0})," "]})):"")))}}]),a}(a),t("default",c)}}});