System.register("suspend/main",["flarum/extend","flarum/app","flarum/utils/UserControls","flarum/components/Button","flarum/components/Badge","flarum/Model","flarum/models/User","suspend/components/SuspendUserModal"],function(e){"use strict";var t,n,s,a,i,u,o,r;return{setters:[function(e){t=e.extend},function(e){n=e["default"]},function(e){s=e["default"]},function(e){a=e["default"]},function(e){i=e["default"]},function(e){u=e["default"]},function(e){o=e["default"]},function(e){r=e["default"]}],execute:function(){n.initializers.add("suspend",function(){o.prototype.canSuspend=u.attribute("canSuspend"),o.prototype.suspendUntil=u.attribute("suspendUntil",u.transformDate),t(s,"moderationControls",function(e,t){t.canSuspend()&&e.add("suspend",a.component({children:"Suspend",icon:"ban",onclick:function(){return n.modal.show(new r({user:t}))}}))}),t(o.prototype,"badges",function(e){var t=this.suspendUntil();new Date<t&&e.add("suspended",i.component({icon:"times",type:"suspended",label:"Suspended"}))})})}}}),System.register("suspend/components/SuspendUserModal",["flarum/components/Modal","flarum/components/Button"],function(e){"use strict";function t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var s,a,i,u=function(){function e(e,t){for(var n=0;n<t.length;n++){var s=t[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,n,s){return n&&e(t.prototype,n),s&&e(t,s),t}}(),o=function(e,t,n){for(var s=!0;s;){var a=e,i=t,u=n;o=l=r=void 0,s=!1,null===a&&(a=Function.prototype);var o=Object.getOwnPropertyDescriptor(a,i);if(void 0!==o){if("value"in o)return o.value;var r=o.get;return void 0===r?void 0:r.call(u)}var l=Object.getPrototypeOf(a);if(null===l)return void 0;e=l,t=i,n=u,s=!0}};return{setters:[function(e){s=e["default"]},function(e){a=e["default"]}],execute:function(){i=function(e){function s(){t(this,s);for(var e=arguments.length,n=Array(e),a=0;e>a;a++)n[a]=arguments[a];o(Object.getPrototypeOf(s.prototype),"constructor",this).apply(this,n);var i=this.props.user.suspendUntil(),u=null;new Date>i&&(i=null),i&&(u=9999===i.getFullYear()?"indefinitely":"limited"),this.status=m.prop(u),this.daysRemaining=m.prop("limited"===u&&-moment().diff(i,"days")+1)}return n(s,e),u(s,[{key:"className",value:function(){return"SuspendUserModal Modal--small"}},{key:"title",value:function(){return"Suspend "+this.props.user.username()}},{key:"content",value:function(){var e=this;return m("div",{className:"Modal-body"},m("div",{className:"Form"},m("div",{className:"Form-group"},m("label",null,"Suspension Status"),m("div",null,m("label",{className:"checkbox"},m("input",{type:"radio",name:"status",checked:!this.status(),onclick:m.withAttr("value",this.status)}),"Not suspended"),m("label",{className:"checkbox"},m("input",{type:"radio",name:"status",checked:"indefinitely"===this.status(),value:"indefinitely",onclick:m.withAttr("value",this.status)}),"Suspended indefinitely"),m("label",{className:"checkbox SuspendUserModal-days"},m("input",{type:"radio",name:"status",checked:"limited"===this.status(),value:"limited",onclick:function(t){e.status(t.target.value),m.redraw(!0),e.$(".SuspendUserModal-days-input input").select(),m.redraw.strategy("none")}}),"Suspended for a limited time...","limited"===this.status()?m("div",{className:"SuspendUserModal-days-input"},m("input",{type:"number",value:this.daysRemaining(),oninput:m.withAttr("value",this.daysRemaining),className:"FormControl"})," days"):""))),m("div",{className:"Form-group"},a.component({children:"Save Changes",className:"Button Button--primary",loading:this.loading}))))}},{key:"onsubmit",value:function(e){var t=this;e.preventDefault(),this.loading=!0;var n=null;switch(this.status()){case"indefinitely":n=new Date("9999-12-31");break;case"limited":n=moment().add(this.daysRemaining(),"days").toDate()}this.props.user.save({suspendUntil:n}).then(function(){return t.hide()},function(){t.loading=!1,m.redraw()})}}]),s}(s),e("default",i)}}});